SELECT dates.eval_date thisdate, opportunity_id, NVL(SUM(kwh_0015), 0) kwh_0015, NVL(SUM(kwh_0030), 0) kwh_0030, NVL(SUM(kwh_0045), 0) kwh_0045, NVL(SUM(kwh_0100), 0) kwh_0100, NVL(SUM(kwh_0115), 0) kwh_0115, NVL(SUM(kwh_0130), 0) kwh_0130, NVL(SUM(kwh_0145), 0) kwh_0145, NVL(SUM(kwh_0200), 0) kwh_0200, NVL(SUM(kwh_0215), 0) kwh_0215, NVL(SUM(kwh_0230), 0) kwh_0230, NVL(SUM(kwh_0245), 0) kwh_0245, NVL(SUM(kwh_0300), 0) kwh_0300, NVL(SUM(kwh_0315), 0) kwh_0315, NVL(SUM(kwh_0330), 0) kwh_0330, NVL(SUM(kwh_0345), 0) kwh_0345, NVL(SUM(kwh_0400), 0) kwh_0400, NVL(SUM(kwh_0415), 0) kwh_0415, NVL(SUM(kwh_0430), 0) kwh_0430, NVL(SUM(kwh_0445), 0) kwh_0445, NVL(SUM(kwh_0500), 0) kwh_0500, NVL(SUM(kwh_0515), 0) kwh_0515, NVL(SUM(kwh_0530), 0) kwh_0530, NVL(SUM(kwh_0545), 0) kwh_0545, NVL(SUM(kwh_0600), 0) kwh_0600, NVL(SUM(kwh_0615), 0) kwh_0615, NVL(SUM(kwh_0630), 0) kwh_0630, NVL(SUM(kwh_0645), 0) kwh_0645, NVL(SUM(kwh_0700), 0) kwh_0700, NVL(SUM(kwh_0715), 0) kwh_0715, NVL(SUM(kwh_0730), 0) kwh_0730, NVL(SUM(kwh_0745), 0) kwh_0745, NVL(SUM(kwh_0800), 0) kwh_0800, NVL(SUM(kwh_0815), 0) kwh_0815, NVL(SUM(kwh_0830), 0) kwh_0830, NVL(SUM(kwh_0845), 0) kwh_0845, NVL(SUM(kwh_0900), 0) kwh_0900, NVL(SUM(kwh_0915), 0) kwh_0915, NVL(SUM(kwh_0930), 0) kwh_0930, NVL(SUM(kwh_0945), 0) kwh_0945, NVL(SUM(kwh_1000), 0) kwh_1000, NVL(SUM(kwh_1015), 0) kwh_1015, NVL(SUM(kwh_1030), 0) kwh_1030, NVL(SUM(kwh_1045), 0) kwh_1045, NVL(SUM(kwh_1100), 0) kwh_1100, NVL(SUM(kwh_1115), 0) kwh_1115, NVL(SUM(kwh_1130), 0) kwh_1130, NVL(SUM(kwh_1145), 0) kwh_1145, NVL(SUM(kwh_1200), 0) kwh_1200, NVL(SUM(kwh_1215), 0) kwh_1215, NVL(SUM(kwh_1230), 0) kwh_1230, NVL(SUM(kwh_1245), 0) kwh_1245, NVL(SUM(kwh_1300), 0) kwh_1300, NVL(SUM(kwh_1315), 0) kwh_1315, NVL(SUM(kwh_1330), 0) kwh_1330, NVL(SUM(kwh_1345), 0) kwh_1345, NVL(SUM(kwh_1400), 0) kwh_1400, NVL(SUM(kwh_1415), 0) kwh_1415, NVL(SUM(kwh_1430), 0) kwh_1430, NVL(SUM(kwh_1445), 0) kwh_1445, NVL(SUM(kwh_1500), 0) kwh_1500, NVL(SUM(kwh_1515), 0) kwh_1515, NVL(SUM(kwh_1530), 0) kwh_1530, NVL(SUM(kwh_1545), 0) kwh_1545, NVL(SUM(kwh_1600), 0) kwh_1600, NVL(SUM(kwh_1615), 0) kwh_1615, NVL(SUM(kwh_1630), 0) kwh_1630, NVL(SUM(kwh_1645), 0) kwh_1645, NVL(SUM(kwh_1700), 0) kwh_1700, NVL(SUM(kwh_1715), 0) kwh_1715, NVL(SUM(kwh_1730), 0) kwh_1730, NVL(SUM(kwh_1745), 0) kwh_1745, NVL(SUM(kwh_1800), 0) kwh_1800, NVL(SUM(kwh_1815), 0) kwh_1815, NVL(SUM(kwh_1830), 0) kwh_1830, NVL(SUM(kwh_1845), 0) kwh_1845, NVL(SUM(kwh_1900), 0) kwh_1900, NVL(SUM(kwh_1915), 0) kwh_1915, NVL(SUM(kwh_1930), 0) kwh_1930, NVL(SUM(kwh_1945), 0) kwh_1945, NVL(SUM(kwh_2000), 0) kwh_2000, NVL(SUM(kwh_2015), 0) kwh_2015, NVL(SUM(kwh_2030), 0) kwh_2030, NVL(SUM(kwh_2045), 0) kwh_2045, NVL(SUM(kwh_2100), 0) kwh_2100, NVL(SUM(kwh_2115), 0) kwh_2115, NVL(SUM(kwh_2130), 0) kwh_2130, NVL(SUM(kwh_2145), 0) kwh_2145, NVL(SUM(kwh_2200), 0) kwh_2200, NVL(SUM(kwh_2215), 0) kwh_2215, NVL(SUM(kwh_2230), 0) kwh_2230, NVL(SUM(kwh_2245), 0) kwh_2245, NVL(SUM(kwh_2300), 0) kwh_2300, NVL(SUM(kwh_2315), 0) kwh_2315, NVL(SUM(kwh_2330), 0) kwh_2330, NVL(SUM(kwh_2345), 0) kwh_2345, NVL(SUM(kwh_2400), 0) kwh_2400, NVL(SUM(kwh_2415), 0) kwh_2415, NVL(SUM(kwh_2430), 0) kwh_2430, NVL(SUM(kwh_2445), 0) kwh_2445, NVL(SUM(kwh_2500), 0) kwh_2500 
FROM 
 (SELECT COLUMN_VALUE AS eval_date FROM TABLE (esg_trx2.date_table (TO_DATE('20170401', 'YYYYMMDD'), TO_DATE('20190331', 'YYYYMMDD')))) dates, 
 (SELECT * FROM wesportal_forecast WHERE opportunity_id=100) wpf 
WHERE dates.eval_date=wpf.forecast_date(+) AND (ldc_duns LIKE '%3' OR (ldc_duns IS NULL AND opportunity_id IS NULL)) 
GROUP BY dates.eval_date, forecast_date, opportunity_id 
ORDER BY 1;